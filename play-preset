#!/usr/bin/env perl
use strict;
use warnings;
use feature qw(say);

use List::MoreUtils qw(firstidx);
use Soundbridge;

my $sb = Soundbridge->new;
my @presets = $sb->rcp('ListPresets');

if (my $play = join ' ', @ARGV) {
    my $index = $play =~ /\D/
                    ? firstidx { /$play/i } @presets
                    : $play - 1;
    {
        local $| = 1;
        print "Playing $presets[$index]... ";
    }
    say for $sb->rcp("PlayPreset $index");
} else {
    print $_+1, ". $presets[$_]\n" for 0..$#presets;
}
